# Production Environment Configuration

# ===============================
# Database Configuration - Production
# ===============================
spring.datasource.url=${DATABASE_URL}
spring.datasource.username=${DATABASE_USERNAME}
spring.datasource.password=${DATABASE_PASSWORD}
spring.datasource.driver-class-name=org.postgresql.Driver

# Connection Pool Configuration
spring.datasource.hikari.maximum-pool-size=20
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.leak-detection-threshold=60000

# SSL Configuration for Database
spring.datasource.hikari.data-source-properties.ssl=true
spring.datasource.hikari.data-source-properties.sslmode=require

# JPA Configuration - Production settings
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
spring.flyway.enabled=true

# ===============================
# Security Configuration - Production
# ===============================
# JWT Configuration - Production secrets from environment
eventping.security.jwt.secret=${JWT_SECRET}
eventping.security.jwt.expiration=3600000
eventping.security.jwt.refresh-expiration=86400000

# Password Security - Maximum security
eventping.security.password.bcrypt-rounds=15

# Session Security - Strict
eventping.security.session.timeout=900
eventping.security.session.max-concurrent=2

# CORS - Restricted to production domains
eventping.security.cors.allowed-origins=${CORS_ALLOWED_ORIGINS}

# ===============================
# Rate Limiting - Strict for Production
# ===============================
eventping.rate-limit.enabled=true
eventping.rate-limit.redis.enabled=true

# Strict rate limits
eventping.rate-limit.ip.requests-per-minute=60
eventping.rate-limit.user.api-requests-per-minute=30
eventping.rate-limit.registration.attempts-per-hour=3
eventping.rate-limit.login.attempts-per-hour=5

# ===============================
# Logging - Production settings
# ===============================
logging.level.root=WARN
logging.level.org.springframework.security=INFO
logging.level.org.springframework.web=WARN
logging.level.thomas.com.EventPing=INFO
logging.level.org.hibernate.SQL=WARN

# Log to file in production
logging.file.name=/var/log/eventping/application.log
logging.file.max-size=100MB
logging.file.max-history=30
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n

# ===============================
# Actuator - Restricted in production
# ===============================
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=when-authorized
management.endpoint.health.roles=ADMIN
management.endpoints.web.base-path=/actuator
management.server.port=8081

# ===============================
# Cache Configuration - Redis for production
# ===============================
spring.cache.type=redis
spring.data.redis.host=${REDIS_HOST}
spring.data.redis.port=${REDIS_PORT:6379}
spring.data.redis.password=${REDIS_PASSWORD}
spring.data.redis.ssl.enabled=true
spring.data.redis.timeout=2000ms

# ===============================
# Audit Logging - Full logging in production
# ===============================
eventping.audit.enabled=true
eventping.audit.log-authentication=true
eventping.audit.log-authorization-failures=true
eventping.audit.log-data-modifications=true
eventping.audit.log-security-violations=true
eventping.audit.retention-days=365

# ===============================
# Email Configuration - Production SMTP
# ===============================
spring.mail.host=${SMTP_HOST}
spring.mail.port=${SMTP_PORT:587}
spring.mail.username=${SMTP_USERNAME}
spring.mail.password=${SMTP_PASSWORD}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.ssl.trust=${SMTP_HOST}

# ===============================
# SSL/TLS Configuration
# ===============================
server.ssl.enabled=true
server.ssl.key-store=${SSL_KEYSTORE_PATH}
server.ssl.key-store-password=${SSL_KEYSTORE_PASSWORD}
server.ssl.key-store-type=PKCS12
server.ssl.key-alias=eventping

# Force HTTPS
server.require-ssl=true
security.require-ssl=true

# ===============================
# Validation - Strict in production
# ===============================
eventping.validation.sql-injection.enabled=true
eventping.validation.xss.enabled=true
eventping.validation.email.domain-validation=true
eventping.validation.file-upload.max-size=5MB

# ===============================
# Monitoring and Alerting
# ===============================
eventping.monitoring.enabled=true
eventping.monitoring.alert-email=${ALERT_EMAIL}
eventping.monitoring.slack-webhook=${SLACK_WEBHOOK_URL}

# ===============================
# Performance Configuration
# ===============================
server.tomcat.max-threads=200
server.tomcat.min-spare-threads=10
server.tomcat.max-connections=8192
server.tomcat.accept-count=100
server.tomcat.connection-timeout=20000

# ===============================
# Public URLs
# ===============================
eventping.public.base-url=${PUBLIC_BASE_URL:https://eventping.app/e/}